#!/bin/sh
# Dump available arichitecture information

echo "uname: machine $(uname -m), kernel $(uname -s -r), OS $(uname -o)"

if [ -x /usr/bin/dpkg ] || which dpkg > /dev/null 2>&1 ; then
    # "dpkg-architecture -qDEB_HOST_ARCH" calls "dpkg --print-architecture"
    echo "dpkg architecture: $(dpkg --print-architecture)"
fi

if [ -x /usr/bin/gcc ] || which gcc > /dev/null 2>&1 ; then
    echo "gcc target triple: $(gcc -dumpmachine)"
    echo "gcc -march=native flags:" \
        $(gcc -march=native -E -v - < /dev/null 2>&1 > /dev/null | \
            sed -n 's/ /  /g;s/ -[Ev]\? / /g;s/ \+/ /g;s/^ *.*cc1\(.*\)$/\1/p')
fi
